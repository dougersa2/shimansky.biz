/*
 2010?2013 Vadim Makeev, pepelsbey.net
 @license MIT license: github.com/shower/shower/wiki/MIT-License
*/
window.shower=window.shower||function(e,f,q){function p(b){for(var a in b)b.hasOwnProperty(a)&&(this[a]=b[a])}var a={},k=e.location,g=f.body,h=[],n=[],l,m=!(!e.history||!e.history.pushState);p.prototype={getSlideNumber:function(){return this.number},isLast:function(){return a.slideList.length===this.number+1},isFinished:function(){return this.innerComplete>=this.innerLength},process:function(a){if(this.timing)return this.initTimer(a),this;this.next(a);return this},initTimer:function(a){var c=this;
if(!c.timing)return!1;c.stopTimer();l=c.isFinished()?setInterval(function(){c.stopTimer();a.next()},c.timing*(c.innerLength||1)):setInterval(function(){c.isFinished()?(c.stopTimer(),a.next()):c.next(a)},c.timing);return this},stopTimer:function(){l&&(clearInterval(l),l=!1);return this},prev:function(a){var c;if(!this.hasInnerNavigation||this.isFinished()||0===this.innerComplete)return a.prev(),!1;c=f.getElementById(this.id).querySelectorAll(".next.active");if(!c||1>c.length)return!1;0<this.innerComplete?
(this.innerComplete--,c[c.length-1].classList.remove("active")):a.prev();return this},next:function(a){if(!this.hasInnerNavigation||this.isFinished())return a.next(),!1;this.isFinished()||(a=f.getElementById(this.id).querySelectorAll(".next:not(.active)"),a[0].classList.add("active"),this.innerComplete++);return this}};a._getData=function(a,c){return a.dataset?a.dataset[c]:a.getAttribute("data-"+c)};a.slideList=[];a.init=function(b,c){var d;c=c||"div.progress div";h=f.querySelectorAll(b||".slide");
n=f.querySelector(c);for(var e=0;e<h.length;e++)h[e].id||(h[e].id=e+1),(d=a._getData(h[e],"timing"))&&/^(\d{1,2}:)?\d{1,3}$/.test(d)?(-1!==d.indexOf(":")?(d=d.split(":"),d=1E3*(60*parseInt(d[0],10)+parseInt(d[1],10))):d=1E3*parseInt(d,10),0===d&&(d=!1)):d=!1,a.slideList.push(new p({id:h[e].id,number:e,hasInnerNavigation:null!==h[e].querySelector(".next"),timing:d,innerLength:h[e].querySelectorAll(".next").length,innerComplete:0}));return a};a._getTransform=function(){return"scale("+1/Math.max(g.clientWidth/
e.innerWidth,g.clientHeight/e.innerHeight)+")"};a._applyTransform=function(a){["WebkitTransform","MozTransform","msTransform","OTransform","transform"].forEach(function(c){g.style[c]=a});return!0};a._isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};a._normalizeSlideNumber=function(b){if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");0>b&&(b=0);b>=a.slideList.length&&(b=a.slideList.length-1);return b};a._getSlideIdByEl=function(a){for(;"BODY"!==a.nodeName&&"HTML"!==
a.nodeName;){if(a.classList.contains("slide"))return a.id;a=a.parentNode}return""};a._checkInteractiveElement=function(a){return"A"===a.target.nodeName};a.getSlideNumber=function(b){var c=a.slideList.length-1,d;for(""===b&&(d=0);0<=c;--c)if(b===a.slideList[c].id){d=c;break}return d};a.go=function(b,c){var d;if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");if(!a.slideList[b])return!1;k.hash=a.getSlideHash(b);a.updateProgress(b);a.updateActiveAndVisitedSlides(b);a.isSlideMode()&&
(a.showPresenterNotes(b),d=a.slideList[b],d.timing&&d.initTimer(a));"function"===typeof c&&c();return b};a.next=function(b){var c=a.getCurrentSlideNumber();if(!a.slideList[c+1])return!1;a.go(c+1);"function"===typeof b&&b();return this};a._turnNextSlide=function(b){var c=a.getCurrentSlideNumber(),d=a.slideList[c];a.isSlideMode()?(d.stopTimer(),d.next(a)):a.go(c+1);"function"===typeof b&&b()};a.prev=a.previous=function(b){var c=a.getCurrentSlideNumber();if(1>c)return!1;a.go(c-1);"function"===typeof b&&
b();return!0};a._turnPreviousSlide=function(b){var c=a.getCurrentSlideNumber(),d=a.slideList[c];d.stopTimer();a.isSlideMode()?d.prev(a):a.go(c-1);"function"===typeof b&&b();return!0};a.first=function(b){var c=a.slideList[a.getCurrentSlideNumber()];c&&c.timing&&c.stopTimer();a.go(0);"function"===typeof b&&b()};a.last=function(b){var c=a.slideList[a.getCurrentSlideNumber()];c&&c.timing&&c.stopTimer();a.go(a.slideList.length-1);"function"===typeof b&&b()};a.enterSlideMode=function(b){var c=a.getCurrentSlideNumber();
g.classList.remove("list");g.classList.add("full");a.isListMode()&&m&&history.pushState(null,null,k.pathname+"?full"+a.getSlideHash(c));a._applyTransform(a._getTransform());"function"===typeof b&&b();return!0};a.enterListMode=function(b){var c;g.classList.remove("full");g.classList.add("list");a.clearPresenterNotes();a._applyTransform("none");if(a.isListMode())return!1;c=a.getCurrentSlideNumber();a.slideList[c].stopTimer();a.isSlideMode()&&m&&history.pushState(null,null,k.pathname+a.getSlideHash(c));
a.scrollToSlide(c);"function"===typeof b&&b();return!0};a.toggleMode=function(b){a.isListMode()?a.enterSlideMode():a.enterListMode();"function"===typeof b&&b();return!0};a.getCurrentSlideNumber=function(){var b=a.slideList.length-1,c=k.hash.substr(1);if(""===c)return-1;for(;0<=b;--b)if(c===a.slideList[b].id)return b;return 0};a.scrollToSlide=function(b){var c=!1;if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");if(a.isSlideMode())throw Error("You can't scroll to because you in slide mode. Please, switch to list mode.");
if(-1===b)return c;if(a.slideList[b])b=f.getElementById(a.slideList[b].id),e.scrollTo(0,b.offsetTop);else throw Error("There is no slide with number "+b);return!0};a.isListMode=function(){return m?!/^full.*/.test(k.search.substr(1)):g.classList.contains("list")};a.isSlideMode=function(){return m?/^full.*/.test(k.search.substr(1)):g.classList.contains("full")};a.updateProgress=function(b){if(null===n)return!1;if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");n.style.width=(100/
(a.slideList.length-1)*a._normalizeSlideNumber(b)).toFixed(2)+"%";return!0};a.updateActiveAndVisitedSlides=function(b){var c,d,e=a.slideList.length;b=a._normalizeSlideNumber(b);if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");for(c=0;c<e;++c)d=f.getElementById(a.slideList[c].id),c<b?(d.classList.remove("active"),d.classList.add("visited")):c>b?(d.classList.remove("visited"),d.classList.remove("active")):(d.classList.remove("visited"),d.classList.add("active"));return!0};a.clearPresenterNotes=
function(){a.isSlideMode()&&e.console&&e.console.clear&&console.clear()};a.showPresenterNotes=function(b){a.clearPresenterNotes();if(e.console){b=a._normalizeSlideNumber(b);var c=a.slideList[b+1]?a.slideList[b+1].id:null;(b=f.getElementById(a.slideList[b].id).querySelector("footer"))&&b.innerHTML&&console.info(b.innerHTML.replace(/\n\s+/g,"\n"));c&&(c=f.getElementById(c).querySelector("h2"))&&(c=c.innerHTML.replace(/^\s+|<[^>]+>/g,""),console.info("NEXT: "+c))}};a.getSlideHash=function(b){if(!a._isNumber(b))throw Error("Gimme slide number as Number, baby!");
b=a._normalizeSlideNumber(b);return"#"+a.slideList[b].id};a.wheel=function(b){var c=f.querySelector("body");"locked"===c.getAttribute("data-scroll")||a.isListMode()||(c.setAttribute("data-scroll","locked"),(b=b.deltaY===q?0>b.wheelDeltaY:0<b.deltaY)?a._turnNextSlide():a._turnPreviousSlide(),setTimeout(function(){c.setAttribute("data-scroll","unlocked")},200))};e.addEventListener("DOMContentLoaded",function(){var b=a.getCurrentSlideNumber(),c=g.classList.contains("full")||a.isSlideMode();-1===b&&c?
a.go(0):(0===b||c)&&a.go(b);c&&a.enterSlideMode()},!1);e.addEventListener("popstate",function(){var b=a.getCurrentSlideNumber();-1!==b&&a.go(b);a.isListMode()?a.enterListMode():a.enterSlideMode()},!1);e.addEventListener("resize",function(){a.isSlideMode()&&a._applyTransform(a._getTransform())},!1);f.addEventListener("keydown",function(b){var c=a.getCurrentSlideNumber(),d=a.slideList[-1!==c?c:0];switch(b.which){case 80:a.isListMode()&&b.altKey&&b.metaKey&&(b.preventDefault(),b=d.number,a.go(b),a.enterSlideMode(),
a.showPresenterNotes(b),d.timing&&d.initTimer(a));break;case 116:b.preventDefault();a.isListMode()?(b=b.shiftKey?d.number:0,a.go(b),a.enterSlideMode(),a.showPresenterNotes(b),d.timing&&d.initTimer(a)):a.enterListMode();break;case 13:a.isListMode()&&-1!==c&&(b.preventDefault(),a.enterSlideMode(),a.showPresenterNotes(c),d.timing&&d.initTimer(a));break;case 27:a.isSlideMode()&&(b.preventDefault(),a.enterListMode());break;case 33:case 38:case 37:case 72:case 75:if(b.altKey||b.ctrlKey||b.metaKey)break;
b.preventDefault();a._turnPreviousSlide();break;case 34:case 40:case 39:case 76:case 74:if(b.altKey||b.ctrlKey||b.metaKey)break;b.preventDefault();a._turnNextSlide();break;case 36:b.preventDefault();a.first();break;case 35:b.preventDefault();a.last();break;case 9:case 32:b.preventDefault(),a[b.shiftKey?"_turnPreviousSlide":"_turnNextSlide"]()}},!1);a.init();f.addEventListener("click",function(b){(b=a._getSlideIdByEl(b.target))&&a.isListMode()&&(b=a.getSlideNumber(b),a.go(b),a.enterSlideMode(),a.showPresenterNotes(b),
b=a.slideList[b],b.timing&&b.initTimer(a))},!1);f.addEventListener("touchstart",function(b){var c=a._getSlideIdByEl(b.target);c&&(a.isSlideMode()&&!a._checkInteractiveElement(b)&&(b=b.touches[0].pageX,b>e.innerWidth/2?a._turnNextSlide():a._turnPreviousSlide()),a.isListMode()&&(c=a.getSlideNumber(c),a.go(c),a.enterSlideMode(),a.showPresenterNotes(c),c=a.slideList[c],c.timing&&c.initTimer(a)))},!1);f.addEventListener("touchmove",function(b){a.isSlideMode()&&b.preventDefault()},!1);f.addEventListener("wheel",
a.wheel,!1);f.addEventListener("mousewheel",a.wheel,!1);return a}(this,this.document);
//# sourceMappingURL=shower.min.js.map
